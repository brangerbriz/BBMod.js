<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\BB.Particle2D.js - liBB.js</title>
        
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/prettify-nick.css">

    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    
    <script src="../assets/vendor/yui-min.js"></script>
</head>
<body>

<div id="doc">
    <div id="bd" class="main-body">

        <div id="docs-sidebar" class="sidebar apidocs">
            <div id="api-list">
                <div id="api-tabview" class="tabview">
                    <ul class="tabs">
                        <a href="/docs">
                            <img src="../assets/favicon.png" class="icon"/>
                        </a>
                        <a href="/docs" class="homelink"> liBB.js </a>
                        <!-- <li><a href="#api-classes">Classes</a></li> -->
                        <!-- <li><a href="#api-modules">Modules</a></li> -->
                    </ul>
            
                    <div id="api-tabview-filter">
                        <input type="search" id="api-filter" placeholder="Type to filter APIs">
                    </div>
            
                    <div id="api-tabview-panel">
                        <ul id="api-classes" class="apis classes">
                            <li><a class="type" href="../classes/BB.AudioAnalyser.html">BB.AudioAnalyser</a></li>
                            <li><a class="type" href="../classes/BB.AudioBufferLoader.html">BB.AudioBufferLoader</a></li>
                            <li><a class="type" href="../classes/BB.AudioSampler.html">BB.AudioSampler</a></li>
                            <li><a class="type" href="../classes/BB.AudioStream.html">BB.AudioStream</a></li>
                            <li><a class="type" href="../classes/BB.BaseBrush2D.html">BB.BaseBrush2D</a></li>
                            <li><a class="type" href="../classes/BB.BaseMidiInput.html">BB.BaseMidiInput</a></li>
                            <li><a class="type" href="../classes/BB.BrushManager2D.html">BB.BrushManager2D</a></li>
                            <li><a class="type" href="../classes/BB.Color.html">BB.Color</a></li>
                            <li><a class="type" href="../classes/BB.ImageBrush2D.html">BB.ImageBrush2D</a></li>
                            <li><a class="type" href="../classes/BB.LineBrush2D.html">BB.LineBrush2D</a></li>
                            <li><a class="type" href="../classes/BB.MathUtils.html">BB.MathUtils</a></li>
                            <li><a class="type" href="../classes/BB.MidiDevice.html">BB.MidiDevice</a></li>
                            <li><a class="type" href="../classes/BB.MidiInputButton.html">BB.MidiInputButton</a></li>
                            <li><a class="type" href="../classes/BB.MidiInputKey.html">BB.MidiInputKey</a></li>
                            <li><a class="type" href="../classes/BB.MidiInputKnob.html">BB.MidiInputKnob</a></li>
                            <li><a class="type" href="../classes/BB.MidiInputPad.html">BB.MidiInputPad</a></li>
                            <li><a class="type" href="../classes/BB.MidiInputSlider.html">BB.MidiInputSlider</a></li>
                            <li><a class="type" href="../classes/BB.MouseInput.html">BB.MouseInput</a></li>
                            <li><a class="type" href="../classes/BB.Particle2D.html">BB.Particle2D</a></li>
                            <li><a class="type" href="../classes/BB.Pointer.html">BB.Pointer</a></li>
                            <li><a class="type" href="../classes/BB.Vector2.html">BB.Vector2</a></li>
                        </ul>
            
                      <!--   <ul id="api-modules" class="apis modules">
                            <li><a class="module" href="../modules/BB.AudioAnalyser.html">BB.AudioAnalyser</a></li>
                            <li><a class="module" href="../modules/BB.AudioBufferLoader.html">BB.AudioBufferLoader</a></li>
                            <li><a class="module" href="../modules/BB.AudioSampler.html">BB.AudioSampler</a></li>
                            <li><a class="module" href="../modules/BB.AudioStream.html">BB.AudioStream</a></li>
                            <li><a class="module" href="../modules/BB.BaseBrush2D.html">BB.BaseBrush2D</a></li>
                            <li><a class="module" href="../modules/BB.BaseMidiInput.html">BB.BaseMidiInput</a></li>
                            <li><a class="module" href="../modules/BB.BrushManager2D.html">BB.BrushManager2D</a></li>
                            <li><a class="module" href="../modules/BB.Color.html">BB.Color</a></li>
                            <li><a class="module" href="../modules/BB.ImageBrush2D.html">BB.ImageBrush2D</a></li>
                            <li><a class="module" href="../modules/BB.LeapMotion.html">BB.LeapMotion</a></li>
                            <li><a class="module" href="../modules/BB.LineBrush2D.html">BB.LineBrush2D</a></li>
                            <li><a class="module" href="../modules/BB.MathUtils.html">BB.MathUtils</a></li>
                            <li><a class="module" href="../modules/BB.Midi.html">BB.Midi</a></li>
                            <li><a class="module" href="../modules/BB.MouseInput.html">BB.MouseInput</a></li>
                            <li><a class="module" href="../modules/BB.particle2D.html">BB.particle2D</a></li>
                            <li><a class="module" href="../modules/BB.Pointer.html">BB.Pointer</a></li>
                            <li><a class="module" href="../modules/BB.Vector2.html">BB.Vector2</a></li>
                        </ul> -->
                    </div>
                </div>
            </div>
        </div>

        <div id="docs-main" class="apidocs">
            <div class="content container">
    <h1 class="file-heading">File: src\BB.Particle2D.js</h1>
    
    <div class="file">
    <pre class="code prettyprint overflow linenums">
    /**
     * A 2D Particle class for all your physics needs
     * @module BB.particle2D
     */
    define([&#x27;./BB&#x27;, &#x27;./BB.Vector2&#x27;], 
    function(  BB,        Vector2){
    
        &#x27;use strict&#x27;;
    
        BB.Vector2 = Vector2;
    
    
        /**
         * A 2D Particle class for all your physics needs
         * @class BB.Particle2D
         * @constructor
         * @param {Object} [config] An optional config object to initialize
         * Particle2D properties, including: position ( object with x and y ), mass
         * ( defaults to 1 ), radius ( defaults to 0 ) and friction ( defaults to 1
         * ).
         *
         * an initial velocity or acceleration can also be set by passing a
         * BB.Vector2 to either of those properties ( ie. velocity or acceleration
         * ). Or an alternative approach is to initialize with a heading property
         * (radians) and speed property ( number ). If no velocity or acceleration
         * or heading/speed is set, the default velocity is BB.Vector2(0,0).
         * 
         * @example  &lt;code class=&quot;code prettyprint&quot;&gt;&amp;nbsp; var WIDTH = window.innerWidth;&lt;br&gt;
         * &amp;nbsp; var HEIGHT = window.innerHeight;&lt;br&gt;&lt;br&gt;
         * &amp;nbsp; var star = newBB.Particle2D({ &lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; position: new BB.Vector2(WIDTH/2, HEIGHT/2 ),&lt;br&gt; 
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; mass: 20000 &lt;br&gt; 
         * &amp;nbsp;}); &lt;br&gt;&lt;br&gt; 
         * &amp;nbsp; var planet = new BB.Particle2D({ &lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; position: new BB.Vector2( WIDTH/2+200, HEIGHT/2),&lt;br&gt; 
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; heading: -Math.PI / 2, &lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; speed: 10 &lt;br&gt; 
         * &amp;nbsp; }); &lt;br&gt;&lt;br&gt;
         * &amp;nbsp; var comet = new BB.Particle2D({&lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; position: new BB.Vector2( &lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; BB.MathUtils.randomInt(WIDTH), &lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; BB.MathUtils.randomInt(HEIGHT) ), &lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; velocity: new BB.Vector2( &lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; BB.MathUtils.randomInt(10),&lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; BB.MathUtils.randomInt(10)) &lt;br&gt;
         * &amp;nbsp; });
         * &lt;/code&gt;
         */
        
        BB.Particle2D = function(config) {
    
            // position -------------------------------------------------
            var x = (config &amp;&amp; typeof config.x === &#x27;number&#x27;) ? config.x : 0;
            var y = (config &amp;&amp; typeof config.y === &#x27;number&#x27;) ? config.y : 0;
            this.position = (config &amp;&amp; typeof config.position === &#x27;object&#x27; &amp;&amp; config.position instanceof BB.Vector2) 
                                ? config.position : new BB.Vector2(x, y);
            /**
             * the particle&#x27;s velocity ( see acceleration also )
             * @property velocity
             * @type BB.Vector2
             */  
            if( typeof config.velocity !== &quot;undefined&quot; &amp;&amp; typeof config.heading !== &#x27;undefined&#x27; || 
                typeof config.velocity !== &quot;undefined&quot; &amp;&amp; typeof config.speed !== &#x27;undefined&#x27; ){
    
                throw new Error(&quot;BB.Particle2D: either use heading/speed or velocity (can&#x27;t initialize with both)&quot;);
            }
            else if (typeof config.velocity !== &#x27;undefined&#x27; &amp;&amp; config.velocity instanceof BB.Vector2) {
                this.velocity = config.velocity; // set velocity as per config vector
            } 
            else if(typeof config.velocity !== &#x27;undefined&#x27; &amp;&amp; !(config.velocity instanceof BB.Vector2) ) {
                throw new Error(&quot;BB.Particle2D: velocity must be an instance of BB.Vector2&quot;);
            }        
            else if(typeof config.speed !== &#x27;undefined&#x27; || typeof config.heading !== &#x27;undefined&#x27;){
                
                if(typeof config.speed !== &#x27;undefined&#x27; &amp;&amp; typeof config.speed !== &#x27;number&#x27; ){
                    throw new Error(&quot;BB.Particle2D: speed must be a number&quot;);
                }
                else if(typeof config.heading !== &#x27;undefined&#x27; &amp;&amp; typeof config.heading !== &#x27;number&#x27; ){
                    throw new Error(&quot;BB.Particle2D: heading must be a number in radians&quot;);
                }
                else if(typeof config.heading !== &#x27;undefined&#x27; &amp;&amp; typeof config.speed === &#x27;undefined&#x27;){
                    throw new Error(&quot;BB.Particle2D: when setting a heading, a speed parameter is also required&quot;);
                }
                else if(typeof config.speed !== &#x27;undefined&#x27; &amp;&amp; typeof config.heading === &#x27;undefined&#x27;){
                    throw new Error(&quot;BB.Particle2D: when setting a speed, a heading parameter is also required&quot;);
                }
                else {
                    // we&#x27;ve got both heading + speed, &amp;&amp; their both numbers, 
                    // so create velocity vector based on heading/speed
                    this.velocity = new BB.Vector2(0, 0);
                    this.velocity.x = Math.cos(config.heading) * config.speed;
                    this.velocity.y = Math.sin(config.heading) * config.speed;
                }
            }
            else {
                this.velocity = new BB.Vector2(0, 0); // default velocity vector
            }
    
    
            /**
             * Usually used to accumulate forces to be added to velocity each frame
             * @property acceleration
             * @type BB.Vector2
             */  
            if( typeof config.acceleration !== &quot;undefined&quot; &amp;&amp; typeof config.velocity !== &quot;undefined&quot; || 
                typeof config.acceleration !== &quot;undefined&quot; &amp;&amp; typeof config.heading !== &quot;undefined&quot; || 
                typeof config.acceleration !== &quot;undefined&quot; &amp;&amp; typeof config.speed !== &quot;undefined&quot;){
                throw new Error(&quot;BB.Particle2D: acceleration shouldn&#x27;t be initialized along with velocity or heading/speed, use one or the other&quot;);
            } else {
                this.acceleration = (config &amp;&amp; typeof config.acceleration === &#x27;object&#x27; &amp;&amp; config.acceleration instanceof BB.Vector2) 
                                ? config.acceleration : new BB.Vector2(0, 0);
            }
            
    
            /**
             * the particle&#x27;s mass
             * @property mass
             * @type Number
             * @default 1
             */  
            this.mass     = (config &amp;&amp; typeof config.mass === &#x27;number&#x27;) ? config.mass : 1;
            /**
             * the particle&#x27;s radius, used for callculating collistions
             * @property radius
             * @type Number
             * @default 0
             */  
            this.radius   = (config &amp;&amp; typeof config.radius === &#x27;number&#x27;) ? config.radius : 0;
            /**
             * the particle&#x27;s friction ( not environment&#x27;s friction ) multiplied by velocity each frame
             * @property friction
             * @type Number
             * @default 1
             */  
            this.friction = (config &amp;&amp; typeof config.friction === &#x27;number&#x27;) ? config.friction : 1;
            /**
             * how bouncy it is when it collides with an object
             * @property elasticity
             * @type Number
             * @default 0.05
             */  
            this.elasticity = (config &amp;&amp; typeof config.elasticity === &#x27;number&#x27;) ? config.elasticity : 0.05;
    
            this.maxSpeed = (config &amp;&amp; typeof config.maxSpeed === &#x27;number&#x27;) ? config.maxSpeed : 100;
    
            this._springs      = []; 
            this._colliders    = []; // array of: other Particles ( x,y,r ) to collide against
            this._world        = {}; // object w/: left, right, top, bottom properties, &quot;walls&quot;, ie. perimeter for colliding    
            this._gravitations = []; // array of: Vectors or Object{ position:..., mass:... }
    
        };
    
    
    
        /**
         * the particle&#x27;s &quot;heading&quot;, essentially: Math.atan2( velocity.y,  velocity.x );
         * @property heading
         * @type Number
         */   
        Object.defineProperty(BB.Particle2D.prototype, &#x27;heading&#x27;, {
            get: function() {
                return Math.atan2(this.velocity.y, this.velocity.x);
            },
            set: function(heading) {
                this.velocity.x = Math.cos(heading) * this.speed;
                this.velocity.y = Math.sin(heading) * this.speed;
            }
        });
    
        /**
         * the particle&#x27;s &quot;speed&quot;, essentially: the square root of velocity.x&amp;#178; + velocity.y&amp;#178;
         * @property speed
         * @type Number
         */  
        Object.defineProperty(BB.Particle2D.prototype, &#x27;speed&#x27;, {
            get: function() {
                return Math.sqrt(this.velocity.x * this.velocity.x + this.velocity.y * this.velocity.y);
            },
            set: function(speed) {
                this.velocity.x = Math.cos(this.heading) * speed;
                this.velocity.y = Math.sin(this.heading) * speed;
            }
        });
    
    
    
    
        /**
         * identifies something to gravitate towards. the object of gravitation needs to
         * have a position ( x, y ) and mass
         * 
         * @method gravitate
         * 
         * @param {Object} particle if passed as the only argument it should be an
         * Object with a position.x, position.y and mass ( ie. an instance of
         * BB.Particle2D ). Otherwise the first argument needs to be an Object with
         * an x and y ( ie. instance of BB.Vector2 or at the very least { x: ..., y:
         * ... } )
         *
         * alternatively, gravitate could also be passed an &lt;b&gt;array&lt;/b&gt; of objects 
         * ( each with position and mass properties )
         * 
         * @param {Number} [mass] when particle is not an instance of BB.Particle2D
         * and is a Vector an additional argument for mass is required
         * 
         * @example 
         * &lt;code class=&quot;code prettyprint&quot;&gt; 
         * &amp;nbsp; // assuming star and planet are both instances of BB.Particle2D  &lt;br&gt;
         * &amp;nbsp; planet.gravitate( star ); &lt;br&gt;
         * &amp;nbsp; // or &lt;br&gt;
         * &amp;nbsp; planet.gravitate( star.position, star.mass ); &lt;br&gt;
         * &amp;nbsp; // or &lt;br&gt;
         * &amp;nbsp; planet.gravitate( { x:WIDTH/2, y:HEIGHT/2 }, 20000 ); &lt;br&gt;&lt;br&gt;
         * &amp;nbsp; // assuming stars is an array of BB.particle2D &lt;br&gt;
         * &amp;nbsp; planet.gravitate( stars );&lt;br&gt;
         * &lt;/code&gt;
         */
        BB.Particle2D.prototype.gravitate = function( particle, mass ) {
            var part;
    
            // if array --------------------------------------------------------------------
            if( particle instanceof Array ){
                for (var i = 0; i &lt; particle.length; i++) {
    
                    var p = particle[i];
    
                    if( typeof p === &quot;undefined&quot;){
                        throw new Error(&#x27;BB.Particle2D: gravitate array is empty&#x27;);
                    }
                    else if( p instanceof BB.Particle2D ){
                        this._gravitations.push({ position:p.position, mass:p.mass });
                    }
                    else if( p instanceof BB.Vector2 &amp;&amp; typeof mass === &quot;number&quot; ){
                        part = { position:p };
                        this._gravitations.push({ position:part.position, mass:mass });
                    }
                    else if( p instanceof BB.Vector2 &amp;&amp; typeof mass !== &quot;number&quot; ){
                        throw new Error(&#x27;BB.Particle2D: gravitate array objects are missing a mass&#x27;);
                    }
                    else if( !(p instanceof BB.Vector2) ){
                        if( typeof p.x === &quot;undefined&quot; || typeof p.y === &quot;undefined&quot; ){
                            throw new Error(&#x27;BB.Particle2D: gravitate array items should be objects with x and y properties&#x27;);
                        } 
                        else if( typeof mass == &quot;undefined&quot;){
                            throw new Error(&#x27;BB.Particle2D: gravitate array objects are missing a mass&#x27; );
                        }
                        else {
                            part = { position:{x:p.x, y:p.y } };
                            this._gravitations.push({ position:part.position, mass:mass });
                        }
                    }
                }
            }
            
            // if single particle -----------------------------------------------------------
            else {
               
                if( typeof particle === &quot;undefined&quot;){
                    throw new Error(&#x27;BB.Particle2D: gravitate is missing arguments&#x27;);
                }
                else if( particle instanceof BB.Particle2D ){
                    this._gravitations.push({ position:particle.position, mass:particle.mass });
                }
                else if( particle instanceof BB.Vector2 &amp;&amp; typeof mass === &quot;number&quot; ){
                    part = { position:particle };
                    this._gravitations.push({ position:part.position, mass:mass });
                }
                else if( particle instanceof BB.Vector2 &amp;&amp; typeof mass !== &quot;number&quot; ){
                    throw new Error(&#x27;BB.Particle2D: gravitate\&#x27;s second argument requires a number ( mass )&#x27;);
                }
                else if( !(particle instanceof BB.Vector2) ){
                    if( typeof particle.x === &quot;undefined&quot; || typeof particle.y === &quot;undefined&quot; ){
                        throw new Error(&#x27;BB.Particle2D: gravitate argument should be an object with an x and y property&#x27;);
                    } 
                    else if( typeof mass == &quot;undefined&quot;){
                        throw new Error(&#x27;BB.Particle2D: gravitate\&#x27;s second argument requires a number ( mass )&#x27; );
                    }
                    else {
                        part = { position:{x:particle.x, y:particle.y } };
                        this._gravitations.push({ position:part.position, mass:mass });
                    }
                }            
            }
    
    
        };
    
    
    
        /**
         * identifies something to spring towards. the target needs to have an x,y
         * position, a k value which is a constant factor characteristic of the spring 
         * ( ie. its stiffness, usually some decimal ), and a length.
         * 
         * @method spring
         * 
         * @param {Object} config object with properties for point ( vector with x,y ), 
         * k ( number ) and length ( number ).
         *
         * alternatively, spring could also be passed an &lt;b&gt;array&lt;/b&gt; of config objects 
         * 
         * @example 
         * &lt;code class=&quot;code prettyprint&quot;&gt; 
         * &amp;nbsp; // assuming ball is an instance of BB.Particle2D &lt;br&gt;
         * &amp;nbsp; // and center is an object with x,y positions &lt;br&gt;
         * &amp;nbsp; ball.spring({ &lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; position: center.position,&lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; k: 0.1,&lt;br&gt;
         * &amp;nbsp;&amp;nbsp;&amp;nbsp; length: 100&lt;br&gt;
         * &amp;nbsp; });&lt;br&gt;
         * &amp;nbsp; &lt;br&gt;
         * &amp;nbsp; // the ball will spring back and forth forever from the center position &lt;br&gt;
         * &amp;nbsp; // unless ball has friction value below the default of 1.0
         * &lt;/code&gt;
         */
        BB.Particle2D.prototype.spring = function( config ) {
    
            // if array --------------------------------------------------------------------
            if( config instanceof Array ){
    
                for (var i = 0; i &lt; config.length; i++) {
    
                    var p = config[i];
    
                    if( typeof p === &quot;undefined&quot;){
                        throw new Error(&#x27;BB.Particle2D: spring array is empty, expecting config objects&#x27;);
                    }
                    else if( typeof p !== &quot;object&quot; || p.position === &quot;undefined&quot; ||
                              typeof p.k === &quot;undefined&quot; ||  typeof p.length === &quot;undefined&quot;){
                        throw new Error(&#x27;BB.Particle2D: spring array expecting config objects, with properies for position, length and k&#x27;);
                    }
                    else if( typeof p.position.x !== &quot;number&quot; || typeof p.position.y !== &quot;number&quot; ){
                        throw new Error(&#x27;BB.Particle2D: spring array objects\&#x27; positions should have x and y properties ( numbers )&#x27;);   
                    }
                    else if( typeof p.k !== &quot;number&quot; ){
                        throw new Error(&#x27;BB.Particle2D: spring array object\&#x27;s k properties should be numbers ( usually a float )&#x27;);   
                    }
                    else if( typeof p.length !== &quot;number&quot; ){
                        throw new Error(&#x27;BB.Particle2D: spring array object\&#x27;s length properties should be numbers ( usually a integers &#x27;);   
                    }
                    else {
                        this._springs.push({ position:p.position, k:p.k, length:p.length });
                    }
    
                }
            }
            
            // if single target -----------------------------------------------------------
            else {
               
                if( typeof config === &quot;undefined&quot;){
                    throw new Error(&#x27;BB.Particle2D: spring is missing arguments&#x27;);
                }
                else if( typeof config !== &quot;object&quot; || config.position === &quot;undefined&quot; ||
                          typeof config.k === &quot;undefined&quot; ||  typeof config.length === &quot;undefined&quot;){
                    throw new Error(&#x27;BB.Particle2D: spring expecting a config object, with properies for position, length and k&#x27;);
                }
                else if( typeof config.position.x !== &quot;number&quot; || typeof config.position.y !== &quot;number&quot; ){
                    throw new Error(&#x27;BB.Particle2D: config.position should have x and y properties ( numbers )&#x27;);   
                }
                else if( typeof config.k !== &quot;number&quot; ){
                    throw new Error(&#x27;BB.Particle2D: config.k property should be a number ( usually a float )&#x27;);   
                }
                else if( typeof config.length !== &quot;number&quot; ){
                    throw new Error(&#x27;BB.Particle2D: config.length property should be a number ( usually an integer )&#x27;);   
                }
                else {
                    this._springs.push( { position:config.position, k:config.k, length:config.length } );
                }
            }
    
    
        };
    
    
        /**
         * tracks objects to collide against, this can be other particles ( objects with 
         * position vectors and a radius ) and/or a perimeter ( top, left, right, bottom )
         * 
         * @method collide
         * 
         * @param {Object} config object with properties for top, left, bottom, right ( all numbers ) and particles ( array of other 
         * particles or objects with position.x, positon.y and radius properties )
         *       
         * @example 
         * &lt;code class=&quot;code prettyprint&quot;&gt; 
         * &amp;nbsp; // assuming ball is an instance of BB.Particle2D &lt;br&gt;
         * &amp;nbsp; // assuming balls is an array of BB.Particle2D objects &lt;br&gt;
         * &amp;nbsp; ball.collide({ &lt;br&gt; 
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; top:0, &lt;br&gt; 
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; right: canvas.width, &lt;br&gt; 
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; bottom: canvas.height, &lt;br&gt; 
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; left: 0, &lt;br&gt; 
         * &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; particles: balls &lt;br&gt; 
         * &amp;nbsp; });&lt;br&gt;
         * &lt;/code&gt;
         */
        BB.Particle2D.prototype.collide = function( config ) {
    
            if( typeof config === &quot;undefined&quot; ){
                throw new Error(&#x27;BB.Particle2D: collide requires arguments to konw what to collide against&#x27;);   
            }
    
    
            // perimeter -----------------------------------------------
            if( typeof config.dampen !== &quot;undefined&quot;) this._world.dampen = config.dampen;
             
            if( typeof config.left !== &quot;undefined&quot; ) this._world.left = config.left;        
    
            if( typeof config.right !== &quot;undefined&quot; ) this._world.right = config.right;
    
            if( typeof config.top !== &quot;undefined&quot; ) this._world.top = config.top;
            
            if( typeof config.bottom !== &quot;undefined&quot; ) this._world.bottom = config.bottom;    
    
            // other particles -----------------------------------------
            var i = 0;
            if( typeof config.particles !== &quot;undefined&quot; ){ // when sent along w/ above parameters
                if( !(config.particles instanceof Array) ){
                    throw new Error(&#x27;BB.Particle2D: collide: particles value expecting array of particles&#x27;);   
                } 
                else {
                    for (i = 0; i &lt; config.particles.length; i++) {
                        // if(  !( config.particles[i] instanceof BB.Particle2D ) ){
                        if( typeof config.particles[i].position.x === &quot;undefined&quot; ) {
                            throw new Error(&#x27;BB.Particle2D: collide: particles[&#x27;+i+&#x27;] is missing a position.x&#x27;);  
                        }
                        if( typeof config.particles[i].position.y === &quot;undefined&quot; ) {
                            throw new Error(&#x27;BB.Particle2D: collide: particles[&#x27;+i+&#x27;] is missing a position.y&#x27;);  
                        }
                        if( typeof config.particles[i].radius === &quot;undefined&quot; ) {
                            throw new Error(&#x27;BB.Particle2D: collide: particles[&#x27;+i+&#x27;] is missing a radius&#x27;);  
                        }
                        this._colliders = config.particles;
                    }
                }
            }
            
    
        };
    
    
    
        BB.Particle2D.prototype.update = function() {
    
            var i = 0;
            var accVector = new BB.Vector2();
            var dx, dy, ax, ay, tx, ty, 
                dist, distSQ, distMin, 
                force, angle;
    
    
            // apply gravitations ---------------------------------------- 
            for (i = 0; i &lt; this._gravitations.length; i++) {
                var g = this._gravitations[i];
    
                dx = g.position.x - this.position.x; 
                dy = g.position.y - this.position.y;
                distSQ = dx * dx + dy * dy;
                dist = Math.sqrt(distSQ);
                force = g.mass / distSQ;
    
                ax = dx / dist * force;
                ay = dy / dist * force;
                accVector.set( ax, ay );
                this.applyForce( accVector );
                // this.acceleration.add( new BB.Vector2(ax,ay) );
            }
            
    
    
            // apply springs ----------------------------------------
            for (i = 0; i &lt; this._springs.length; i++) {
                var s = this._springs[i];
    
                dx = s.position.x - this.position.x;
                dy = s.position.y - this.position.y;
                dist = Math.sqrt(dx * dx + dy * dy);
                force = (dist - s.length || 0) * s.k; 
                
                ax = dx / dist * force;
                ay = dy / dist * force;            
                accVector.set( ax, ay );
                this.applyForce( accVector );
            }
    
    
            // apply collisions ----------------------------------------
            for (i = 0; i &lt; this._colliders.length; i++) {
    
                var c = this._colliders[i];            
    
                if( c !== this ){
                    dx = c.position.x - this.position.x;
                    dy = c.position.y - this.position.y;
                    dist = Math.sqrt(dx*dx + dy*dy);
                    distMin = c.radius + this.radius;
    
                    if (dist &lt; distMin) { 
                        angle = Math.atan2(dy, dx);
                        tx = this.position.x + Math.cos(angle) * distMin;
                        ty = this.position.y + Math.sin(angle) * distMin;
                        ax = (tx - c.position.x) * this.elasticity;
                        ay = (ty - c.position.y) * this.elasticity;
                        accVector.set( -ax, -ay);
                        this.applyForce( accVector );
                    }         
                }
            }
    
            if( typeof this._world.left !== &quot;undefined&quot; ){
                if( (this.position.x - this.radius) &lt; this._world.left ){
                    this.position.x = this._world.left + this.radius;
                    this.velocity.x = -this.velocity.x;
                    this.velocity.x *= this._world.dampen || 0.7;
                }
            }
    
            if( typeof this._world.right !== &quot;undefined&quot; ){
                if( (this.position.x + this.radius) &gt; this._world.right ){
                    this.position.x = this._world.right - this.radius;
                    this.velocity.x = -this.velocity.x;
                    this.velocity.x *= this._world.dampen || 0.7;
                }
            }
    
            if( typeof this._world.top !== &quot;undefined&quot; ){
                if( (this.position.y - this.radius) &lt; this._world.top ) {
                    this.position.y = this._world.top + this.radius;
                    this.velocity.y = -this.velocity.y;
                    this.velocity.y *= this._world.dampen || 0.7;
                }
            }
    
            if( typeof this._world.bottom !== &quot;undefined&quot; ){
                if( (this.position.y + this.radius) &gt; this._world.bottom ) {
                    this.position.y = this._world.bottom - this.radius;
                    this.velocity.y = -this.velocity.y;
                    this.velocity.y *= this._world.dampen || 0.7;
                }
            }
    
            // this.acceleration.multiplyScalar(this.friction); // NOT WORKING?
            this.velocity.multiplyScalar(this.friction);      // APPLYING DIRECTLY TO VELOCITY INSTEAD
    
            this.velocity.add(this.acceleration);
            
            if (this.velocity.length() &gt; this.maxSpeed) {
                this.velocity.setLength(this.maxSpeed);
            }
    
            this.position.add(this.velocity);
    
            this.acceleration.multiplyScalar(0);
    
            this._gravitations = [];
            this._springs = [];
            this._colliders = [];
            
        };
    
        /**
         * takes a force, divides it by particle&#x27;s mass, and applies it to acceleration ( which is added to velocity each frame )
         * 
         * @method applyForce
         * 
         * @param {BB.Vector2} vector force to be applied
         */
        BB.Particle2D.prototype.applyForce = function(force) {
    
            if (typeof force !== &#x27;object&#x27; || ! (force instanceof BB.Vector2)) {
                throw new Error(&#x27;BB.Particle2D.applyForce: force parameter must be present and an instance of BB.Vector2&#x27;);
            }
    
            return this.acceleration.add( force.clone().divideScalar(this.mass) );
    
        };
    
        return BB.Particle2D;
    });
    </pre>
    </div>
            </div>
        </div>

    </div>
</div>

<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>

<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
