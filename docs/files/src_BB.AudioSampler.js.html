<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/BB.AudioSampler.js - BB.js</title>
        
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/prettify-nick.css">

    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    
    <script src="../assets/vendor/yui-min.js"></script>
</head>
<body>

<div id="doc">
    <div id="bd" class="main-body">

        <div id="docs-sidebar" class="sidebar apidocs">
            <div id="api-list">
                <div id="api-tabview" class="tabview">
                    <ul class="tabs">
                        <li><a href="#api-classes">Classes</a></li>
                        <!-- <li><a href="#api-modules">Modules</a></li> -->
                    </ul>
            
                    <div id="api-tabview-filter">
                        <input type="search" id="api-filter" placeholder="Type to filter APIs">
                    </div>
            
                    <div id="api-tabview-panel">
                        <ul id="api-classes" class="apis classes">
                            <li><a class="type" href="../classes/BB.AudioAnalyser.html">BB.AudioAnalyser</a></li>
                            <li><a class="type" href="../classes/BB.AudioBufferLoader.html">BB.AudioBufferLoader</a></li>
                            <li><a class="type" href="../classes/BB.AudioSampler.html">BB.AudioSampler</a></li>
                            <li><a class="type" href="../classes/BB.AudioStream.html">BB.AudioStream</a></li>
                            <li><a class="type" href="../classes/BB.BaseBrush2D.html">BB.BaseBrush2D</a></li>
                            <li><a class="type" href="../classes/BB.BrushManager2D.html">BB.BrushManager2D</a></li>
                            <li><a class="type" href="../classes/BB.Color.html">BB.Color</a></li>
                            <li><a class="type" href="../classes/BB.ImageBrush2D.html">BB.ImageBrush2D</a></li>
                            <li><a class="type" href="../classes/BB.LineBrush2D.html">BB.LineBrush2D</a></li>
                            <li><a class="type" href="../classes/BB.MathUtils.html">BB.MathUtils</a></li>
                            <li><a class="type" href="../classes/BB.MouseInput.html">BB.MouseInput</a></li>
                            <li><a class="type" href="../classes/BB.Particle2D.html">BB.Particle2D</a></li>
                            <li><a class="type" href="../classes/BB.Pointer.html">BB.Pointer</a></li>
                            <li><a class="type" href="../classes/BB.Vector2.html">BB.Vector2</a></li>
                        </ul>
            
                      <!--   <ul id="api-modules" class="apis modules">
                            <li><a class="module" href="../modules/BB.AudioAnalyser.html">BB.AudioAnalyser</a></li>
                            <li><a class="module" href="../modules/BB.AudioBufferLoader.html">BB.AudioBufferLoader</a></li>
                            <li><a class="module" href="../modules/BB.AudioSampler.html">BB.AudioSampler</a></li>
                            <li><a class="module" href="../modules/BB.AudioStream.html">BB.AudioStream</a></li>
                            <li><a class="module" href="../modules/BB.BaseBrush2D.html">BB.BaseBrush2D</a></li>
                            <li><a class="module" href="../modules/BB.BrushManager2D.html">BB.BrushManager2D</a></li>
                            <li><a class="module" href="../modules/BB.Color.html">BB.Color</a></li>
                            <li><a class="module" href="../modules/BB.ImageBrush2D.html">BB.ImageBrush2D</a></li>
                            <li><a class="module" href="../modules/BB.LineBrush2D.html">BB.LineBrush2D</a></li>
                            <li><a class="module" href="../modules/BB.MathUtils.html">BB.MathUtils</a></li>
                            <li><a class="module" href="../modules/BB.MouseInput.html">BB.MouseInput</a></li>
                            <li><a class="module" href="../modules/BB.particle2D.html">BB.particle2D</a></li>
                            <li><a class="module" href="../modules/BB.Pointer.html">BB.Pointer</a></li>
                            <li><a class="module" href="../modules/BB.Vector2.html">BB.Vector2</a></li>
                        </ul> -->
                    </div>
                </div>
            </div>
        </div>

        <div id="docs-main" class="apidocs">
            <div class="content container">
    <h1 class="file-heading">File: src/BB.AudioSampler.js</h1>
    
    <div class="file">
    <pre class="code prettyprint overflow linenums">
    /**
     * A module for creating an audio sampler, an object that can load, sample and play back sound files
     * @module BB.AudioSampler
     */
    define([&#x27;./BB&#x27;,&#x27;./BB.AudioBufferLoader&#x27;],
    function(  BB, 		 AudioBufferLoader){
    
    	&#x27;use strict&#x27;;
    
    	BB.AudioBufferLoader = AudioBufferLoader;
    
    	 /**
    	 *  A module for creating an audio sampler, an object that can load, sample and play back sound files
    	 * @class BB.AudioSampler
    	 * @constructor
    	 * 
    	 * @param {Object} config A config object to initialize the Sampler, must contain a &quot;context: AudioContext&quot; 
    	 * property and can contain as many additional properties as there are sound files
    	 * @param {Function} [callback] A callback, with a buffer Object Array
    	 * 
    	 * @example  
    	 * &lt;code class=&quot;code prettyprint&quot;&gt;  
    	 *  &amp;nbsp;var context = new (window.AudioContext || window.webkitAudioContext)();&lt;br&gt;
    	 *	&lt;br&gt;
    	 *	&amp;nbsp;var drum = new BB.AudioSampler({&lt;br&gt;
    	 *	&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;context: context,&lt;br&gt;
    	 *	&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;kick: &#x27;audio/808/kick.ogg&#x27;,&lt;br&gt;
    	 *	&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;snare: &#x27;audio/808/snare.ogg&#x27;,&lt;br&gt;
    	 *	&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;hat: &#x27;audio/808/hat.ogg&#x27;&lt;br&gt;
    	 *	&amp;nbsp;}, function( bufferObj ){&lt;br&gt;
    	 *	&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;console.log( bufferObj )&lt;br&gt;
    	 *	&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;run();&lt;br&gt;
    	 *	&amp;nbsp;});&lt;br&gt;
    	 *	&lt;br&gt;
    	 *	&amp;nbsp;function run(){&lt;br&gt;
    	 *	&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;drum.play(&#x27;kick&#x27;);&lt;br&gt;
    	 *	&amp;nbsp;}&lt;br&gt;
    	 * &lt;/code&gt;
    	 */
        
    
    	BB.AudioSampler = function( config, callback ){
    		
    		/**
    		 * corresponding Audio Context
    		 * @type {AudioContext}
    		 * @property ctx
    		 */
    		this.ctx 		= config.context;
    
    		this.dest 		= this.ctx.destination;
    
    
    		/**
    		 * whether or not to autoload the files
    		 * @type {Boolean}
    		 * @property auto
    		 */
    		this.auto 		= ( typeof config.autoload !== &#x27;undefined&#x27; ) ? config.autoload : true;
    
    		/**
    		 * whether or not the file(s) have loaded
    		 * @type {Boolean}
    		 * @property loaded
    		 */
    		this.loaded		= false;
    
    		/**
    		 * callback to run after loading
    		 * @type {Function}
    		 * @property onload
    		 */
    		this.onload 	= callback;
    
    		/**
    		 * array of sample names
    		 * @type {Array}
    		 * @property keys
    		 */
    		this.keys 		= []; 
    		/**
    		 * array of paths to sample audio files
    		 * @type {Array}
    		 * @property paths
    		 */
    		this.paths  	= []; 
    		/**
    		 * collection of sample buffers
    		 * @type {Object}
    		 * @property buffers
    		 */
    		this.buffers	= {}; 
    		this.loader 	= undefined;
    
    
    		if( !config ) throw new Error(&#x27;BB.AudioSampler: requires a config object&#x27;);
    
    		if( !(this.ctx instanceof AudioContext) ) 
    			throw new Error(&#x27;BB.AudioSampler: context should be an instance of AudioContext&#x27;);
    		
    		if( typeof this.auto !== &#x27;boolean&#x27; ) 
    			throw new Error(&#x27;BB.AudioSampler: autoload should be either true or false&#x27;);
    
    
    
    		for (var key in config ) {
    			if( key!==&#x27;context&#x27; &amp;&amp; key!==&#x27;autoload&#x27;){
    				this.keys.push( key );
    				this.paths.push( config[key] );
    			}
    		}
    
    		if( this.auto===true ) this.load();
    	};
    
    
        /**
         * creates buffers from url paths using BB.AudioBufferLoader, automatically runs in constructor unless autoload is set to false
         * @method load
         */
    	BB.AudioSampler.prototype.load = function(){
    
    		var self = this;
    
    		this.loader = new BB.AudioBufferLoader({
    
    			context: this.ctx,
    			autoload: this.auto,
    			paths: this.paths
    
    		}, function(buffers){
    
    			for (var i = 0; i &lt; buffers.length; i++) {
    				self.buffers[self.keys[i]] = buffers[i];
    			}
    
    			self.loaded = true;
    			
    			if(typeof self.onload !== &#x27;undefined&#x27; ) self.onload( self.buffers ); // callback
    
    		});
    
    	};
    
    	BB.AudioSampler.prototype.connect = function( destination){
    		// WARNING: keep in mind this connect is a little different from webaudio api connect
    		// it has no optional output/input arguments
    		this.dest = destination;
    	};
    
        /**
         * schedules an audio buffer to be played
         * @method play
         * @param {String} key name of particular sample ( declared in constructor ) 
         * @param {Number} [when] scheduled time in the AudioContext&#x27;s timeline/clock (ie. currentTime) to play the file ( default 0, ie. automatically )
         * @param {Number} [offset] default is 0 (ie. beggining of the sample ) but can be offset (seconds) to start at another point in the sample
         * @param {Number} [duration] default is the duration of the entire sample (seconds) can be shortened to a lesser amount
    	 * @example  
    	 * &lt;code class=&quot;code prettyprint&quot;&gt;  
    	 * &amp;nbsp;// plays the sample &quot;fireworks&quot; &lt;br&gt;
    	 * &amp;nbsp;// starts playing it when AudioContext.currentTime == 10&lt;br&gt;
    	 * &amp;nbsp;// starts the sample 30 seconds into the track&lt;br&gt;
    	 * &amp;nbsp;// plays for half a second, then stops&lt;br&gt;
    	 * &amp;nbsp;sampler.play(&#x27;fireworks&#x27;, 10, 30, 0.5);
    	 * &lt;/code&gt;
         */
    	BB.AudioSampler.prototype.play = function( key, when, offset, duration ) {
    
    		if( !key || this.keys.indexOf(key)&lt;0 ) throw new Error(&#x27;BB.AudioSampler: &#x27;+key+&#x27; was not defined in constructor&#x27;);
    
    		var source = this.ctx.createBufferSource(); 
    			source.buffer = this.buffers[ key ];            
    			source.connect( this.dest );   
    
    		var w = ( typeof when !== &#x27;undefined&#x27; ) ? when : 0;
    		var o = ( typeof offset !== &#x27;undefined&#x27; ) ? offset : 0;
    		var d = ( typeof duration !== &#x27;undefined&#x27; ) ? duration : source.buffer.duration;
    
    	    source.start( w, o, d ); 
        };
    
    	return BB.AudioSampler;
    });
    </pre>
    </div>
            </div>
        </div>

    </div>
</div>

<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>

<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
